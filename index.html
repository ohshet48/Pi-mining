<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#5b21b6">
    <title>Pi Mining</title>
    <style>
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
        }
        
        input, button {
            -webkit-user-select: text;
            -moz-user-select: text;
            -ms-user-select: text;
            user-select: text;
        }
        
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #0a1929 0%, #001e3c 100%);
            min-height: 100vh;
            color: white;
            padding: 0;
            overflow-x: hidden;
            overflow-y: auto;
            position: relative;
            touch-action: pan-y;
        }
        
        /* Simplified Tech Background - Single Layer */
        .tech-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            pointer-events: none;
            background: radial-gradient(ellipse at 50% 30%, rgba(0, 200, 220, 0.12) 0%, transparent 60%);
        }
        
        .grid-lines {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            pointer-events: none;
            background-image: 
                linear-gradient(rgba(0, 255, 255, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 255, 255, 0.03) 1px, transparent 1px);
            background-size: 50px 50px;
            opacity: 0.4;
        }
        
        .particle {
            display: none; /* All particles disabled */
        }
        
        .container { 
            max-width: 500px; 
            margin: 0 auto; 
            padding: 20px 20px 60px 20px; 
            position: relative; 
            z-index: 10;
            min-height: 100vh;
        }
        
        /* Auth Screen */
        .auth-screen {
            display: flex;
            flex-direction: column;
            justify-content: center;
            min-height: 100vh;
            padding: 20px;
        }
        
        .auth-logo {
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, #fbbf24, #f97316);
            border-radius: 50%;
            margin: 0 auto 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 20px 60px rgba(251, 191, 36, 0.4);
        }
        
        .auth-logo svg { width: 55px; height: 55px; fill: none; stroke: white; stroke-width: 2.5; }
        
        .auth-title {
            font-size: 36px;
            font-weight: 900;
            text-align: center;
            background: linear-gradient(135deg, #fbbf24, #f97316);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }
        
        .auth-subtitle {
            text-align: center;
            color: #c4b5fd;
            font-size: 15px;
            margin-bottom: 40px;
        }
        
        .auth-card {
            background: rgba(10, 20, 40, 0.85);
            border-radius: 24px;
            padding: 30px;
            border: 2px solid transparent;
            background: 
                linear-gradient(rgba(10, 20, 40, 0.85), rgba(10, 20, 40, 0.85)) padding-box,
                linear-gradient(145deg, rgba(0, 255, 255, 0.4), rgba(123, 67, 255, 0.4)) border-box;
            box-shadow: 
                0 0 30px rgba(0, 255, 255, 0.2),
                0 10px 40px rgba(0, 0, 0, 0.4);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            color: #c4b5fd;
            font-size: 14px;
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            background: rgba(0, 0, 0, 0.4);
            border: 2px solid rgba(0, 255, 255, 0.2);
            border-radius: 12px;
            color: white;
            font-size: 15px;
            outline: none;
        }
        
        /* Date Input Styling */
        input[type="date"].form-input {
            color-scheme: dark;
            position: relative;
        }
        
        input[type="date"].form-input::-webkit-calendar-picker-indicator {
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="%2300ffff" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>') center/contain no-repeat;
            cursor: pointer;
            opacity: 0.8;
            width: 20px;
            height: 20px;
        }
        
        input[type="date"].form-input::-webkit-calendar-picker-indicator:hover {
            opacity: 1;
        }
        
        input[type="date"].form-input::-webkit-datetime-edit {
            color: white;
        }
        
        input[type="date"].form-input::-webkit-datetime-edit-fields-wrapper {
            color: white;
        }
        
        input[type="date"].form-input::-webkit-datetime-edit-text {
            color: #00ffff;
            padding: 0 2px;
        }
        
        input[type="date"].form-input::-webkit-datetime-edit-month-field,
        input[type="date"].form-input::-webkit-datetime-edit-day-field,
        input[type="date"].form-input::-webkit-datetime-edit-year-field {
            color: white;
            background: rgba(0, 255, 255, 0.1);
            border-radius: 4px;
            padding: 2px 4px;
        }
        
        input[type="date"].form-input::-webkit-datetime-edit-month-field:focus,
        input[type="date"].form-input::-webkit-datetime-edit-day-field:focus,
        input[type="date"].form-input::-webkit-datetime-edit-year-field:focus {
            background: rgba(0, 255, 255, 0.2);
            color: #00ffff;
        }
        
        .form-input:-webkit-autofill,
        .form-input:-webkit-autofill:hover,
        .form-input:-webkit-autofill:focus,
        .form-input:-webkit-autofill:active {
            -webkit-box-shadow: 0 0 0 30px rgba(0, 0, 0, 0.4) inset !important;
            -webkit-text-fill-color: white !important;
            background-color: rgba(0, 0, 0, 0.4) !important;
        }
        
        .form-input:disabled {
            background: rgba(0, 0, 0, 0.2) !important;
            border-color: rgba(0, 255, 255, 0.1) !important;
            color: #999 !important;
            cursor: not-allowed;
            -webkit-text-fill-color: #999 !important;
            opacity: 1 !important;
        }
        
        .form-input:disabled:-webkit-autofill,
        .form-input:disabled:-webkit-autofill:hover,
        .form-input:disabled:-webkit-autofill:focus,
        .form-input:disabled:-webkit-autofill:active {
            -webkit-box-shadow: 0 0 0 30px rgba(0, 0, 0, 0.2) inset !important;
            -webkit-text-fill-color: #999 !important;
            background-color: rgba(0, 0, 0, 0.2) !important;
        }
        
        .form-input:disabled:hover,
        .form-input:disabled:focus {
            background: rgba(0, 0, 0, 0.2) !important;
            border-color: rgba(0, 255, 255, 0.1) !important;
            color: #999 !important;
            box-shadow: none !important;
            -webkit-text-fill-color: #999 !important;
        }
        
        .form-input:disabled::-webkit-datetime-edit,
        .form-input:disabled::-webkit-datetime-edit-fields-wrapper,
        .form-input:disabled::-webkit-datetime-edit-text,
        .form-input:disabled::-webkit-datetime-edit-month-field,
        .form-input:disabled::-webkit-datetime-edit-day-field,
        .form-input:disabled::-webkit-datetime-edit-year-field {
            color: #999 !important;
            -webkit-text-fill-color: #999 !important;
        }
        
        .form-input:focus {
            border-color: rgba(0, 255, 255, 0.6);
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.2);
        }
        
        .form-input::placeholder {
            color: rgba(255, 255, 255, 0.3);
        }
        
        .country-dropdown {
            position: relative;
        }
        
        .country-dropdown-list {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            max-height: 250px;
            overflow-y: auto;
            background: rgba(10, 20, 40, 0.98);
            border: 2px solid rgba(0, 255, 255, 0.3);
            border-radius: 12px;
            margin-top: 8px;
            z-index: 1000;
            display: none;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
        }
        
        .country-dropdown-list.show {
            display: block;
        }
        
        .country-option {
            padding: 12px 16px;
            color: white;
            cursor: pointer;
            border-bottom: 1px solid rgba(0, 255, 255, 0.1);
        }
        
        .country-option:hover {
            background: rgba(0, 255, 255, 0.1);
            padding-left: 20px;
        }
        
        .country-option:last-child {
            border-bottom: none;
        }
        
        .country-dropdown-list::-webkit-scrollbar {
            width: 8px;
        }
        
        .country-dropdown-list::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 4px;
        }
        
        .country-dropdown-list::-webkit-scrollbar-thumb {
            background: rgba(0, 255, 255, 0.3);
            border-radius: 4px;
        }
        
        .country-dropdown-list::-webkit-scrollbar-thumb:hover {
            background: rgba(0, 255, 255, 0.5);
        }
        
        .btn {
            width: 100%;
            padding: 16px;
            border: none;
            border-radius: 14px;
            font-size: 17px;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
        }
        
        .btn:active { transform: scale(0.98); }
        
        .btn-primary {
            background: linear-gradient(135deg, #00ffff, #0096ff);
            color: #000;
            margin-bottom: 12px;
        }
        
        .btn-google {
            background: white;
            color: #000;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .divider {
            text-align: center;
            color: #c4b5fd;
            font-size: 14px;
            margin: 20px 0;
            position: relative;
        }
        
        .divider::before,
        .divider::after {
            content: '';
            position: absolute;
            top: 50%;
            width: 40%;
            height: 1px;
            background: rgba(0, 255, 255, 0.2);
        }
        
        .divider::before { left: 0; }
        .divider::after { right: 0; }
        
        .switch-auth {
            text-align: center;
            color: #c4b5fd;
            font-size: 14px;
            margin-top: 20px;
        }
        
        .switch-auth span {
            color: #00ffff;
            cursor: pointer;
            font-weight: 700;
        }
        
        .error-msg {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid rgba(239, 68, 68, 0.5);
            border-radius: 10px;
            padding: 12px;
            margin-bottom: 20px;
            color: #fca5a5;
            font-size: 14px;
            text-align: center;
        }
        
        .success-msg {
            background: rgba(34, 197, 94, 0.2);
            border: 1px solid rgba(34, 197, 94, 0.5);
            border-radius: 10px;
            padding: 12px;
            margin-bottom: 20px;
            color: #86efac;
            font-size: 14px;
            text-align: center;
        }
        
        /* Toast Notification */
        .toast-notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%) translateY(-100px);
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.95), rgba(6, 182, 212, 0.95));
            border: 2px solid rgba(0, 255, 255, 0.5);
            border-radius: 16px;
            padding: 16px 24px;
            color: white;
            font-size: 15px;
            font-weight: 700;
            box-shadow: 
                0 0 30px rgba(0, 255, 255, 0.4),
                0 10px 40px rgba(0, 0, 0, 0.5);
            z-index: 10000;
            opacity: 0;
            pointer-events: none;
            max-width: 90%;
            text-align: center;
        }
        
        .toast-notification.show {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }
        
        .toast-notification.error {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.95), rgba(220, 38, 38, 0.95));
            border-color: rgba(239, 68, 68, 0.5);
            box-shadow: 
                0 0 30px rgba(239, 68, 68, 0.4),
                0 10px 40px rgba(0, 0, 0, 0.5);
        }
        
        /* Header - Minimal */
        .header { text-align: center; padding: 15px 0 10px 0; position: relative; }
        .welcome-card {
            background: rgba(10, 20, 40, 0.85);
            border-radius: 16px;
            padding: 12px 20px;
            display: inline-block;
            border: 2px solid transparent;
            background: 
                linear-gradient(rgba(10, 20, 40, 0.85), rgba(10, 20, 40, 0.85)) padding-box,
                linear-gradient(145deg, rgba(0, 255, 255, 0.4), rgba(123, 67, 255, 0.4)) border-box;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.15);
        }
        .menu-btn {
            position: absolute;
            top: 15px;
            right: 0;
            width: 44px;
            height: 44px;
            background: rgba(10, 20, 40, 0.85);
            border: 2px solid transparent;
            background: 
                linear-gradient(rgba(10, 20, 40, 0.85), rgba(10, 20, 40, 0.85)) padding-box,
                linear-gradient(145deg, rgba(0, 255, 255, 0.4), rgba(123, 67, 255, 0.4)) border-box;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 5px;
            cursor: pointer;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.15);
        }
        .menu-btn:hover {
            box-shadow: 0 0 30px rgba(0, 255, 255, 0.3);
        }
        .menu-btn:active {
            transform: scale(0.95);
        }
        .menu-btn span {
            width: 22px;
            height: 2.5px;
            background: linear-gradient(135deg, #00ffff, #0096ff);
            border-radius: 2px;
        }
        
        /* Menu Sidebar */
        .menu-sidebar {
            position: fixed;
            top: 0;
            right: -50%;
            width: 50%;
            max-width: 320px;
            height: 100vh;
            background: rgba(10, 20, 40, 0.98);
            border-left: 2px solid transparent;
            border-image: linear-gradient(180deg, rgba(0, 255, 255, 0.4), rgba(123, 67, 255, 0.4)) 1;
            box-shadow: -10px 0 40px rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }
        
        .menu-sidebar.open {
            right: 0;
        }
        
        @media (min-width: 640px) {
            .menu-sidebar {
                right: -320px;
                width: 320px;
            }
        }
        
        .menu-header {
            padding: 12px 20px;
            margin: 15px 15px 10px 15px;
            background: rgba(10, 20, 40, 0.9);
            border-radius: 12px;
            border: 1.5px solid rgba(0, 255, 255, 0.4);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            display: inline-block;
            width: auto;
        }
        
        .menu-title {
            font-size: 16px;
            font-weight: 900;
            color: #00ffff;
            text-align: center;
            letter-spacing: 1.5px;
            text-transform: uppercase;
        }
        
        .menu-items {
            padding: 15px 12px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .menu-item {
            padding: 12px 16px;
            color: #c4b5fd;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            border: 1px solid rgba(0, 255, 255, 0.15);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }
        
        .menu-item:hover {
            background: rgba(0, 255, 255, 0.1);
            border-color: rgba(0, 255, 255, 0.4);
            color: #00ffff;
            box-shadow: 0 4px 12px rgba(0, 255, 255, 0.15);
        }
        
        .menu-item:active {
            transform: scale(0.98);
        }
        
        .menu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: rgba(0, 0, 0, 0.7);
            z-index: 999;
            opacity: 0;
            pointer-events: none;
        }
        
        .menu-overlay.show {
            opacity: 1;
            pointer-events: all;
        }
        
        /* Profile Modal */
        .profile-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            z-index: 1100;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .profile-modal.show {
            display: flex;
        }
        
        .profile-backdrop {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
        }
        
        .profile-content {
            position: relative;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            background: rgba(10, 20, 40, 0.95);
            border-radius: 24px;
            border: 2px solid transparent;
            background: 
                linear-gradient(rgba(10, 20, 40, 0.95), rgba(10, 20, 40, 0.95)) padding-box,
                linear-gradient(145deg, rgba(0, 255, 255, 0.4), rgba(123, 67, 255, 0.4)) border-box;
            box-shadow: 0 0 40px rgba(0, 255, 255, 0.3);
        }
        
        .profile-header {
            padding: 30px;
            text-align: center;
            border-bottom: 1px solid rgba(0, 255, 255, 0.2);
        }
        
        .profile-close {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 36px;
            height: 36px;
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(0, 255, 255, 0.2);
            border-radius: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .profile-close:hover {
            background: rgba(0, 0, 0, 0.6);
            border-color: rgba(0, 255, 255, 0.4);
        }
        
        .profile-close svg {
            width: 20px;
            height: 20px;
            stroke: #00ffff;
            stroke-width: 2.5;
        }
        
        .profile-avatar-large {
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, #fbbf24, #f97316);
            border-radius: 50%;
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 42px;
            font-weight: 900;
            color: white;
            box-shadow: 0 10px 30px rgba(251, 191, 36, 0.4);
        }
        
        .profile-name {
            font-size: 28px;
            font-weight: 900;
            color: white;
            margin-bottom: 5px;
        }
        
        .profile-username {
            font-size: 16px;
            color: #8b5cf6;
            font-weight: 600;
        }
        
        .profile-body {
            padding: 20px 30px 30px;
        }
        
        .profile-section {
            margin-bottom: 25px;
        }
        
        .profile-section-title {
            font-size: 14px;
            color: #8b5cf6;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 12px;
        }
        
        .profile-info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }
        
        .profile-info-item {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(0, 255, 255, 0.15);
            border-radius: 14px;
            padding: 14px;
        }
        
        .profile-info-label {
            font-size: 12px;
            color: #c4b5fd;
            margin-bottom: 6px;
        }
        
        .profile-info-value {
            font-size: 20px;
            font-weight: 800;
            color: white;
        }
        
        .profile-stats-row {
            display: flex;
            gap: 10px;
            margin-bottom: 12px;
        }
        
        .profile-stat-card {
            flex: 1;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(0, 255, 255, 0.15);
            border-radius: 14px;
            padding: 16px;
            text-align: center;
        }
        
        .profile-stat-value {
            font-size: 24px;
            font-weight: 900;
            background: linear-gradient(135deg, #00ffff, #0096ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 4px;
        }
        
        .profile-stat-label {
            font-size: 11px;
            color: #c4b5fd;
            font-weight: 600;
        }
        
        .profile-action-btn {
            width: 100%;
            padding: 12px;
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(0, 255, 255, 0.25);
            border-radius: 12px;
            color: #00ffff;
            font-size: 14px;
            font-weight: 700;
            cursor: pointer;
            margin-bottom: 10px;
        }
        
        .profile-action-btn:hover {
            background: rgba(0, 0, 0, 0.6);
            border-color: rgba(0, 255, 255, 0.4);
        }
        
        .profile-action-btn:active {
            transform: scale(0.98);
        }
        
        .profile-logout-btn {
            background: rgba(239, 68, 68, 0.2);
            border: 2px solid rgba(239, 68, 68, 0.4);
            color: #fca5a5;
        }
        
        .profile-delete-btn {
            background: rgba(239, 68, 68, 0.15);
            border: 2px solid rgba(239, 68, 68, 0.3);
            color: #fca5a5;
        }
        
        /* Avatar Upload */
        .profile-avatar-large {
            position: relative;
            background: linear-gradient(135deg, #0096ff, #00ffff) !important;
        }
        
        .profile-avatar-large img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
        }
        
        .avatar-change-btn {
            position: absolute;
            bottom: 0;
            right: 0;
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, #00ffff, #0096ff);
            border: 3px solid rgba(10, 20, 40, 0.95);
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(0, 255, 255, 0.4);
        }
        
        .avatar-change-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0, 255, 255, 0.6);
        }
        
        .avatar-change-btn:active {
            transform: scale(0.95);
        }
        
        .avatar-change-btn svg {
            width: 18px;
            height: 18px;
            fill: #000;
        }
        
        /* Avatar change button for full page */
        .full-page-content .avatar-change-btn {
            position: absolute;
            bottom: 0;
            right: 0;
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, #00ffff, #0096ff);
            border: 3px solid rgba(10, 20, 40, 0.95);
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(0, 255, 255, 0.4);
        }
        
        .full-page-content .avatar-change-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0, 255, 255, 0.6);
        }
        
        .full-page-content .avatar-change-btn:active {
            transform: scale(0.95);
        }
        
        /* Referral Earnings Card */
        .referral-earnings-card {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(0, 255, 255, 0.15);
            border-radius: 14px;
            padding: 16px;
        }
        
        .referral-earnings-main {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 10px;
        }
        
        .referral-earnings-icon {
            font-size: 32px;
        }
        
        .referral-earnings-value {
            font-size: 24px;
            font-weight: 900;
            background: linear-gradient(135deg, #fbbf24, #f97316);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .referral-earnings-label {
            font-size: 12px;
            color: #c4b5fd;
            margin-top: 2px;
        }
        
        .referral-earnings-detail {
            font-size: 13px;
            color: #8b5cf6;
            font-weight: 600;
            text-align: center;
            padding-top: 10px;
            border-top: 1px solid rgba(0, 255, 255, 0.1);
        }
        
        /* Ranking Card */
        .ranking-card {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(0, 255, 255, 0.15);
            border-radius: 14px;
            padding: 16px;
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .ranking-badge {
            text-align: center;
            padding: 10px 20px;
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.2), rgba(249, 115, 22, 0.2));
            border: 2px solid rgba(251, 191, 36, 0.4);
            border-radius: 12px;
        }
        
        .ranking-position {
            font-size: 28px;
            font-weight: 900;
            background: linear-gradient(135deg, #fbbf24, #f97316);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            line-height: 1;
            margin-bottom: 4px;
        }
        
        .ranking-label {
            font-size: 11px;
            color: #fbbf24;
            font-weight: 700;
        }
        
        .ranking-info {
            flex: 1;
        }
        
        .ranking-info-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 13px;
        }
        
        .ranking-info-item:last-child {
            margin-bottom: 0;
        }
        
        .ranking-info-label {
            color: #c4b5fd;
            font-weight: 600;
        }
        
        .ranking-info-value {
            color: white;
            font-weight: 800;
        }
        
        /* Share Buttons */
        .share-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        
        .share-btn {
            padding: 12px;
            border: none;
            border-radius: 12px;
            font-size: 13px;
            font-weight: 700;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .share-btn:active {
            transform: scale(0.95);
        }
        
        .share-twitter {
            background: #1DA1F2;
        }
        
        .share-whatsapp {
            background: #25D366;
        }
        
        .share-telegram {
            background: #0088cc;
        }
        
        .share-copy {
            background: rgba(0, 255, 255, 0.2);
            border: 2px solid rgba(0, 255, 255, 0.4);
        }
        
        /* Change Email/Password Modal */
        .change-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            z-index: 1200;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .change-modal.show {
            display: flex;
        }
        
        .change-modal-content {
            position: relative;
            max-width: 400px;
            width: 100%;
            background: rgba(10, 20, 40, 0.98);
            border-radius: 20px;
            padding: 30px;
            border: 2px solid transparent;
            background: 
                linear-gradient(rgba(10, 20, 40, 0.98), rgba(10, 20, 40, 0.98)) padding-box,
                linear-gradient(145deg, rgba(0, 255, 255, 0.4), rgba(123, 67, 255, 0.4)) border-box;
            box-shadow: 0 0 40px rgba(0, 255, 255, 0.3);
        }
        
        .change-modal-title {
            font-size: 20px;
            font-weight: 900;
            color: white;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .change-modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 30px;
            height: 30px;
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(0, 255, 255, 0.2);
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .change-modal-close:hover {
            background: rgba(0, 0, 0, 0.6);
        }
        
        .change-modal-close svg {
            width: 16px;
            height: 16px;
            stroke: #00ffff;
            stroke-width: 2.5;
        }
        
        /* Full Page Container */
        .full-page {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: linear-gradient(135deg, #0a1929 0%, #001e3c 100%);
            z-index: 2000;
            display: none;
            overflow-y: auto;
        }
        
        .full-page.active {
            display: block;
        }
        
        .full-page-header {
            position: sticky;
            top: 0;
            background: rgba(10, 20, 40, 0.95);
            border-bottom: 1px solid rgba(0, 255, 255, 0.2);
            padding: 15px 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            z-index: 10;
        }
        
        .back-btn {
            width: 40px;
            height: 40px;
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(0, 255, 255, 0.2);
            border-radius: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .back-btn:hover {
            background: rgba(0, 0, 0, 0.6);
            border-color: rgba(0, 255, 255, 0.4);
        }
        
        .back-btn:active {
            transform: scale(0.95);
        }
        
        .back-btn svg {
            width: 22px;
            height: 22px;
            stroke: #00ffff;
            stroke-width: 2.5;
        }
        
        .full-page-title {
            font-size: 22px;
            font-weight: 900;
            color: white;
            flex: 1;
        }
        
        .full-page-content {
            padding: 20px;
            max-width: 500px;
            margin: 0 auto;
        }
        .welcome-text { 
            color: #c4b5fd; 
            font-size: 16px; 
            font-weight: 600;
        }
        .username-text {
            color: #00ffff;
            font-weight: 700;
        }
        
        /* Card - No Blur */
        .card { 
            background: rgba(10, 20, 40, 0.85);
            border-radius: 28px;
            padding: 28px;
            margin-bottom: 18px;
            position: relative;
            border: 2px solid transparent;
            background: 
                linear-gradient(rgba(10, 20, 40, 0.85), rgba(10, 20, 40, 0.85)) padding-box,
                linear-gradient(145deg, rgba(0, 255, 255, 0.4), rgba(123, 67, 255, 0.4)) border-box;
            box-shadow: 
                0 0 30px rgba(0, 255, 255, 0.2),
                0 10px 40px rgba(0, 0, 0, 0.4);
        }
        
        /* Balance - Compact 50% smaller */
        .balance-card {
            padding: 14px 20px !important;
            position: relative;
        }
        .balance-label { 
            color: #c4b5fd; 
            font-size: 12px; 
            text-align: center; 
            margin-bottom: 6px; 
        }
        .balance-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            position: relative;
        }
        .balance-value { 
            font-size: 28px; 
            font-weight: 900; 
            line-height: 1; 
        }
        .balance-unit { 
            font-size: 16px; 
            color: #fbbf24; 
            font-weight: 600; 
        }
        .balance-toggle {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(0, 255, 255, 0.2);
            color: #00bcd4;
            padding: 6px 8px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            position: absolute;
            right: 0;
        }
        .balance-toggle:active {
            transform: scale(0.95);
            background: rgba(0, 0, 0, 0.4);
        }
        .balance-toggle svg {
            width: 20px;
            height: 20px;
            stroke: currentColor;
        }
        
        /* Button */
        .btn-mine { 
            width: 100%;
            padding: 26px;
            border: none;
            border-radius: 20px;
            font-size: 22px;
            font-weight: 700;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 14px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.35);
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
        }
        .btn-mine:active { transform: scale(0.97); }
        .btn-mine svg { width: 36px; height: 36px; }
        
        /* Static Green Border for Mining (No Animation) */
        .mining-glow {
            border: 2px solid #10b981 !important;
            background: 
                linear-gradient(rgba(10, 20, 40, 0.85), rgba(10, 20, 40, 0.85)) padding-box,
                linear-gradient(145deg, #10b981, #10b981) border-box !important;
            box-shadow: 
                0 0 30px rgba(16, 185, 129, 0.4),
                0 10px 40px rgba(0, 0, 0, 0.4) !important;
        }
        
        /* Timer */
        .timer-wrap { text-align: center; }
        .timer-circle {
            width: 140px;
            height: 140px;
            margin: 0 auto 20px;
            position: relative;
        }
        .timer-circle svg { width: 100%; height: 100%; transform: rotate(-90deg); }
        .timer-bg { stroke: rgba(255,255,255,0.12); fill: none; stroke-width: 10; }
        .timer-progress { 
            stroke: #10b981; 
            fill: none; 
            stroke-width: 10;
            stroke-linecap: round;
        }
        .timer-icon {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        .timer-icon svg { width: 52px; height: 52px; stroke: #10b981; }
        .mining-active { color: #10b981; font-weight: 700; font-size: 20px; margin-bottom: 10px; }
        .timer-time { font-size: 40px; font-weight: 900; margin-bottom: 8px; }
        .timer-label { color: #c4b5fd; font-size: 15px; }
        .earning-box {
            background: rgba(16,185,129,0.25);
            border: 1.5px solid rgba(16,185,129,0.4);
            border-radius: 14px;
            padding: 14px;
            margin-top: 18px;
        }
        .earning-text { color: #6ee7b7; font-size: 15px; text-align: center; }
        .earning-amount { font-weight: 800; font-size: 20px; }
        
        /* Stats Grid */
        .stats { 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            gap: 16px; 
            margin-bottom: 18px; 
        }
        .stat {
            background: rgba(10, 20, 40, 0.85);
            border-radius: 20px;
            padding: 14px;
            border: 2px solid transparent;
            background: 
                linear-gradient(rgba(10, 20, 40, 0.85), rgba(10, 20, 40, 0.85)) padding-box,
                linear-gradient(145deg, rgba(0, 255, 255, 0.3), rgba(123, 67, 255, 0.3)) border-box;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.15);
            min-height: 140px;
            max-height: 140px;
            display: flex;
            flex-direction: column;
        }
        .stat-top { display: flex; align-items: center; gap: 10px; margin-bottom: 8px; }
        .stat-icon {
            width: 36px;
            height: 36px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .stat-icon svg { width: 20px; height: 20px; }
        .stat-label { color: #c4b5fd; font-size: 13px; flex: 1; }
        .stat-value { font-size: 24px; font-weight: 900; line-height: 1; }
        .stat-unit { font-size: 13px; color: #c4b5fd; margin-top: 4px; }
        
        /* Level Card - Enhanced */
        .level-progress-bar {
            width: 100%;
            height: 18px;
            background: rgba(10, 20, 40, 0.85);
            border-radius: 10px;
            overflow: hidden;
            position: relative;
            margin-top: 4px;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }
        
        .level-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981, #059669);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .level-progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 9px;
            font-weight: 700;
            color: white;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.8);
        }
        
        .level-claim-card {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.3), rgba(5, 150, 105, 0.3)) !important;
            border: 2px solid #10b981 !important;
            box-shadow: 0 0 30px rgba(16, 185, 129, 0.5) !important;
        }
        
        .congrats-text {
            font-size: 24px;
            font-weight: 900;
            color: #10b981;
            text-align: center;
            margin-bottom: 8px;
        }
        
        .level-reached-text {
            font-size: 18px;
            font-weight: 700;
            color: white;
            text-align: center;
            margin-bottom: 8px;
        }
        
        .reward-text {
            font-size: 15px;
            color: #6ee7b7;
            text-align: center;
            margin-bottom: 12px;
        }
        
        .claim-btn {
            width: 100%;
            padding: 6px;
            background: linear-gradient(135deg, #10b981, #059669);
            border: none;
            border-radius: 10px;
            color: white;
            font-size: 12px;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
        }
        
        .claim-btn:active {
            transform: scale(0.98);
        }
                /* Daily Reward Card */
        .reward-card {
            text-align: center;
            padding: 18px;
        }
        
        .reward-available {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.3), rgba(5, 150, 105, 0.3)) !important;
            border: 2px solid #10b981 !important;
            box-shadow: 0 0 30px rgba(16, 185, 129, 0.5) !important;
        }
        
        .reward-chest {
            width: 70px;
            height: 70px;
            margin: 0 auto 12px;
        }
        
        .reward-chest.locked {
            opacity: 0.4;
        }
        
        .reward-chest.available {
            opacity: 1;
        }
        
        .reward-chest svg {
            width: 100%;
            height: 100%;
            filter: drop-shadow(0 4px 12px rgba(0, 150, 255, 0.4));
        }
        
        .reward-chest.locked svg {
            filter: drop-shadow(0 2px 6px rgba(100, 100, 100, 0.2));
        }
        
        .reward-claim-btn {
            width: 100%;
            padding: 6px;
            background: linear-gradient(135deg, #10b981, #059669);
            border: none;
            border-radius: 10px;
            color: white;
            font-size: 12px;
            font-weight: 700;
            cursor: pointer;
            margin-top: 6px;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }
        
        .reward-claim-btn:active {
            transform: scale(0.98);
        }
        .icon-blue svg { stroke: #93c5fd; fill: none; stroke-width: 2; }
        .icon-purple { background: rgba(168,85,247,0.35); }
        .icon-purple svg { stroke: #d8b4fe; fill: none; stroke-width: 2; }
        .icon-green { background: rgba(16,185,129,0.35); }
        .icon-green svg { stroke: #6ee7b7; fill: none; stroke-width: 2; }
        .icon-orange { background: rgba(249,115,22,0.35); }
        .icon-orange svg { stroke: #fdba74; fill: none; stroke-width: 2; }
        
        /* Section Title */
        .section-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 17px;
            font-weight: 700;
            margin-bottom: 12px;
        }
        .section-title svg { width: 20px; height: 20px; stroke: #93c5fd; }
        
        /* Referral - Compact */
        .ref-compact {
            background: rgba(0,0,0,0.35);
            border: 1.5px solid rgba(59,130,246,0.35);
            border-radius: 12px;
            padding: 12px 14px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
        }
        
        .ref-code-text {
            font-size: 18px;
            font-weight: 800;
            font-family: 'Courier New', monospace;
            color: #93c5fd;
            letter-spacing: 1px;
            flex: 1;
        }
        
        .copy-btn {
            background: rgba(0, 255, 255, 0.2);
            border: 1px solid rgba(0, 255, 255, 0.4);
            color: #00ffff;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .copy-btn:active {
            transform: scale(0.95);
            background: rgba(0, 255, 255, 0.3);
        }
        
        .copy-btn svg {
            width: 16px;
            height: 16px;
            stroke: currentColor;
        }
        
        /* Bonus */
        .bonus-card {
            background: linear-gradient(135deg, rgba(251,191,36,0.25), rgba(249,115,22,0.25));
            border: 1.5px solid rgba(251,191,36,0.4);
        }
        .bonus-text { color: #e9d5ff; font-size: 15px; margin-bottom: 14px; line-height: 1.5; }
        .bonus-highlight { color: #fbbf24; font-weight: 800; }
        .btn-bonus {
            background: linear-gradient(135deg, #fbbf24, #f97316);
            color: white;
            padding: 14px;
            font-size: 17px;
            width: 100%;
            border: none;
            border-radius: 14px;
            font-weight: 700;
            cursor: pointer;
        }
        .btn-disabled {
            background: rgba(100,100,100,0.5);
            color: rgba(255,255,255,0.5);
            cursor: not-allowed;
        }
        
        /* Logout Button */
        .logout-btn {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid rgba(239, 68, 68, 0.4);
            color: #fca5a5;
            padding: 10px 20px;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            display: block;
            margin: 20px auto 0;
        }
        
        /* Footer */
        .footer { text-align: center; padding: 24px 0; }
        .footer-text { color: #c4b5fd; font-size: 13px; }
    </style>
</head>
<body>
    <!-- Toast Notification -->
    <div id="toastNotification" class="toast-notification"></div>
    
    <!-- Tech Background -->
    <div class="tech-bg"></div>
    <div class="grid-lines"></div>
    <div id="particles"></div>
    
    <div id="authScreen" class="auth-screen" style="display:none;">
        <div class="auth-logo">
            <svg viewBox="0 0 24 24">
                <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/>
            </svg>
        </div>
        <h1 class="auth-title">Pi Mining</h1>
        <p class="auth-subtitle">Digital Mining Application</p>
        
        <div class="auth-card">
            <div id="errorMsg" style="display:none;"></div>
            <div id="successMsg" style="display:none;"></div>
            
            <!-- Login Form -->
            <div id="loginForm">
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-input" id="loginEmail" placeholder="Enter your email">
                </div>
                <div class="form-group">
                    <label class="form-label">Password</label>
                    <input type="password" class="form-input" id="loginPassword" placeholder="Enter your password">
                </div>
                <button class="btn btn-primary" onclick="login()">Login</button>
                <div class="divider">OR</div>
                <button class="btn btn-google" onclick="googleLogin()">
                    <svg width="20" height="20" viewBox="0 0 24 24"><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/><path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/><path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/><path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/></svg>
                    Continue with Google
                </button>
                <div class="switch-auth">Don't have an account? <span onclick="showSignup()">Sign Up</span></div>
            </div>
            
            <!-- Signup Form -->
            <div id="signupForm" style="display:none;">
                <div class="form-group">
                    <label class="form-label">Username</label>
                    <input type="text" class="form-input" id="signupUsername" placeholder="Choose a username">
                </div>
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-input" id="signupEmail" placeholder="Enter your email">
                </div>
                <div class="form-group">
                    <label class="form-label">Password</label>
                    <input type="password" class="form-input" id="signupPassword" placeholder="Create a password">
                </div>
                <div class="form-group">
                    <label class="form-label">Confirm Password</label>
                    <input type="password" class="form-input" id="signupPasswordConfirm" placeholder="Confirm your password">
                </div>
                <div class="form-group">
                    <label class="form-label">Referral Code (Optional)</label>
                    <input type="text" class="form-input" id="signupReferral" placeholder="Enter referral code">
                </div>
                <button class="btn btn-primary" onclick="signup()">Create Account</button>
                <div class="divider">OR</div>
                <button class="btn btn-google" onclick="googleLogin()">
                    <svg width="20" height="20" viewBox="0 0 24 24"><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/><path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/><path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/><path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/></svg>
                    Continue with Google
                </button>
                <div class="switch-auth">Already have an account? <span onclick="showLogin()">Login</span></div>
            </div>
        </div>
    </div>
    
    <div class="container" id="app" style="display:none;"></div>
    
    <!-- Menu Sidebar -->
    <div class="menu-overlay" id="menuOverlay" onclick="toggleMenu()"></div>
    <div class="menu-sidebar" id="menuSidebar">
        <div class="menu-header">
            <div class="menu-title">Menu</div>
        </div>
        <div class="menu-items">
            <div class="menu-item" onclick="openPage('profile')">Profile</div>
            <div class="menu-item" onclick="openPage('menu2')">Men 2</div>
            <div class="menu-item" onclick="openPage('menu3')">Men 3</div>
            <div class="menu-item" onclick="openPage('menu4')">Men 4</div>
            <div class="menu-item" onclick="openPage('menu5')">Men 5</div>
            <div class="menu-item" onclick="openPage('menu6')">Men 6</div>
        </div>
    </div>
    
    <!-- Profile Modal -->
    <div class="profile-modal" id="profileModal">
        <div class="profile-backdrop" onclick="closeProfile()"></div>
        <div class="profile-content">
            <div class="profile-header">
                <button class="profile-close" onclick="closeProfile()">
                    <svg viewBox="0 0 24 24" fill="none">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
                <div class="profile-title" style="font-size: 24px; font-weight: 900; color: white; text-align: center; padding: 20px 0 10px;">Profile</div>
                <div style="background: rgba(0, 0, 0, 0.4); border: 1px solid rgba(0, 255, 255, 0.2); border-radius: 12px; padding: 15px; margin: 0 20px 20px; text-align: center;">
                    <div style="font-size: 20px; font-weight: 900; color: white;" id="profileUsername"></div>
                    <div style="font-size: 13px; color: #8b5cf6; margin-top: 4px;" id="profileHandle"></div>
                </div>
            </div>
            <div class="profile-body">
                
                <div class="profile-section">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                        <div class="profile-section-title" style="margin: 0;">Personal Information</div>
                        <button id="editInfoBtn" onclick="toggleEditInfo()" style="background: rgba(0, 255, 255, 0.2); border: 1px solid rgba(0, 255, 255, 0.4); border-radius: 8px; padding: 6px 12px; color: #00ffff; font-size: 12px; font-weight: 700; cursor: pointer;">
                             Edit
                        </button>
                    </div>
                    <div style="background: rgba(0, 0, 0, 0.3); border: 1px solid rgba(0, 255, 255, 0.15); border-radius: 12px; padding: 14px; margin-bottom: 10px;">
                        <div style="font-size: 11px; color: #8b5cf6; font-weight: 600; margin-bottom: 6px;">Full Name</div>
                        <input type="text" id="inputFullName" class="form-input" placeholder="Enter your full name" style="margin: 0;" disabled>
                    </div>
                    <div style="background: rgba(0, 0, 0, 0.3); border: 1px solid rgba(0, 255, 255, 0.15); border-radius: 12px; padding: 14px; margin-bottom: 10px;">
                        <div style="font-size: 11px; color: #8b5cf6; font-weight: 600; margin-bottom: 6px;">Email Address</div>
                        <div style="font-size: 15px; color: #666; font-weight: 700;" id="profileEmail">-</div>
                    </div>
                    <div style="background: rgba(0, 0, 0, 0.3); border: 1px solid rgba(0, 255, 255, 0.15); border-radius: 12px; padding: 14px; margin-bottom: 10px;">
                        <div style="font-size: 11px; color: #8b5cf6; font-weight: 600; margin-bottom: 6px;">Birth Date</div>
                        <input type="date" id="inputBirthDate" class="form-input" style="margin: 0;" min="1923-01-01" max="2007-12-31" disabled>
                        <div id="birthDateError" style="display: none; margin-top: 8px; padding: 8px; background: rgba(239, 68, 68, 0.2); border: 1px solid rgba(239, 68, 68, 0.5); border-radius: 8px; color: #fca5a5; font-size: 12px; font-weight: 600;">
                             Birth year must be between 1923 and 2007
                        </div>
                    </div>
                    <div style="background: rgba(0, 0, 0, 0.3); border: 1px solid rgba(0, 255, 255, 0.15); border-radius: 12px; padding: 14px; margin-bottom: 10px;">
                        <div style="font-size: 11px; color: #8b5cf6; font-weight: 600; margin-bottom: 6px;">Country</div>
                        <div class="country-dropdown">
                            <input type="text" id="inputCountry" class="form-input" placeholder="Select or type your country" style="margin: 0;" disabled autocomplete="off" onfocus="showCountryDropdown('inputCountry', 'countryDropdown')" oninput="filterCountries('inputCountry', 'countryDropdown')">
                            <div id="countryDropdown" class="country-dropdown-list"></div>
                        </div>
                    </div>
                    <button id="saveInfoBtn" class="profile-action-btn" onclick="savePersonalInfo()" style="background: linear-gradient(135deg, #00ffff, #0096ff); color: #000; font-weight: 900; display: none;">
                         Save Information
                    </button>
                </div>
                
                <div class="profile-section">
                    <div class="profile-section-title">Account Settings</div>
                    <button class="profile-action-btn" onclick="showChangeEmail()">
                         Change Email
                    </button>
                    <button class="profile-action-btn" onclick="showChangePassword()">
                         Change Password
                    </button>
                </div>
                
                <div class="profile-section">
                    <div class="profile-section-title">Share Profile</div>
                    <button class="profile-action-btn" onclick="shareProfile()">
                        <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" style="display: inline-block; vertical-align: middle; margin-right: 8px;">
                            <circle cx="18" cy="5" r="3"/>
                            <circle cx="6" cy="12" r="3"/>
                            <circle cx="18" cy="19" r="3"/>
                            <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"/>
                            <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"/>
                        </svg>
                        Share Profile
                    </button>
                </div>
                
                <div class="profile-section">
                    <button class="profile-action-btn profile-logout-btn" onclick="logout()">
                         Logout
                    </button>
                    <button class="profile-action-btn profile-delete-btn" onclick="showDeleteAccount()">
                         Delete Account
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Change Email Modal -->
    <div class="change-modal" id="changeEmailModal">
        <div class="profile-backdrop" onclick="closeChangeEmail()"></div>
        <div class="change-modal-content">
            <button class="change-modal-close" onclick="closeChangeEmail()">
                <svg viewBox="0 0 24 24" fill="none">
                    <line x1="18" y1="6" x2="6" y2="18"/>
                    <line x1="6" y1="6" x2="18" y2="18"/>
                </svg>
            </button>
            <div class="change-modal-title">Change Email</div>
            <div class="form-group">
                <label class="form-label">New Email</label>
                <input type="email" class="form-input" id="newEmail" placeholder="Enter new email">
            </div>
            <div class="form-group">
                <label class="form-label">Current Password</label>
                <input type="password" class="form-input" id="emailPassword" placeholder="Confirm with password">
            </div>
            <button class="profile-action-btn" onclick="changeEmail()">
                 Update Email
            </button>
        </div>
    </div>
    
    <!-- Change Password Modal -->
    <div class="change-modal" id="changePasswordModal">
        <div class="profile-backdrop" onclick="closeChangePassword()"></div>
        <div class="change-modal-content">
            <button class="change-modal-close" onclick="closeChangePassword()">
                <svg viewBox="0 0 24 24" fill="none">
                    <line x1="18" y1="6" x2="6" y2="18"/>
                    <line x1="6" y1="6" x2="18" y2="18"/>
                </svg>
            </button>
            <div class="change-modal-title">Change Password</div>
            <div class="form-group">
                <label class="form-label">Current Password</label>
                <input type="password" class="form-input" id="currentPassword" placeholder="Enter current password">
            </div>
            <div class="form-group">
                <label class="form-label">New Password</label>
                <input type="password" class="form-input" id="newPassword" placeholder="Enter new password">
            </div>
            <div class="form-group">
                <label class="form-label">Confirm New Password</label>
                <input type="password" class="form-input" id="confirmPassword" placeholder="Confirm new password">
            </div>
            <button class="profile-action-btn" onclick="changePassword()">
                 Update Password
            </button>
        </div>
    </div>
    
    <!-- Delete Account Modal -->
    <div class="change-modal" id="deleteAccountModal">
        <div class="profile-backdrop" onclick="closeDeleteAccount()"></div>
        <div class="change-modal-content">
            <button class="change-modal-close" onclick="closeDeleteAccount()">
                <svg viewBox="0 0 24 24" fill="none">
                    <line x1="18" y1="6" x2="6" y2="18"/>
                    <line x1="6" y1="6" x2="18" y2="18"/>
                </svg>
            </button>
            <div class="change-modal-title" style="color: #ef4444;">Delete Account</div>
            <div style="background: rgba(239, 68, 68, 0.1); border: 1px solid rgba(239, 68, 68, 0.3); border-radius: 10px; padding: 12px; margin-bottom: 20px;">
                <div style="color: #fca5a5; font-size: 13px; font-weight: 600;"> Warning: This action cannot be undone!</div>
                <div style="color: #fca5a5; font-size: 12px; margin-top: 5px;">All your data, balance, and progress will be permanently deleted.</div>
            </div>
            <div id="deleteError" style="display: none; background: rgba(239, 68, 68, 0.2); border: 1px solid rgba(239, 68, 68, 0.5); border-radius: 10px; padding: 10px; margin-bottom: 15px;">
                <div style="color: #fca5a5; font-size: 13px; font-weight: 700;"> <span id="deleteErrorText"></span></div>
            </div>
            <div class="form-group">
                <label class="form-label">Enter Your Password to Confirm</label>
                <input type="password" class="form-input" id="deletePassword" placeholder="Enter your password">
            </div>
            <button class="profile-action-btn profile-delete-btn" onclick="event.stopPropagation(); confirmDeleteAccount();" style="cursor: pointer; pointer-events: auto;">
                 Delete Account
            </button>
        </div>
    </div>
    
    <!-- Goodbye Modal -->
    <div class="change-modal" id="goodbyeModal">
        <div class="profile-backdrop"></div>
        <div class="change-modal-content" style="text-align: center;">
            <svg viewBox="0 0 100 100" width="80" height="80" style="margin: 0 auto 20px;">
                <defs>
                    <linearGradient id="sadGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" style="stop-color:#8b5cf6;stop-opacity:1" />
                        <stop offset="100%" style="stop-color:#6366f1;stop-opacity:1" />
                    </linearGradient>
                </defs>
                <!-- Face circle -->
                <circle cx="50" cy="50" r="45" fill="url(#sadGradient)" opacity="0.2"/>
                <circle cx="50" cy="50" r="45" fill="none" stroke="url(#sadGradient)" stroke-width="3"/>
                <!-- Sad eyes -->
                <circle cx="35" cy="42" r="3" fill="#8b5cf6"/>
                <circle cx="65" cy="42" r="3" fill="#8b5cf6"/>
                <!-- Tears -->
                <path d="M 35 48 Q 33 55 32 60" stroke="#6366f1" stroke-width="2" fill="none" stroke-linecap="round" opacity="0.6"/>
                <path d="M 65 48 Q 67 55 68 60" stroke="#6366f1" stroke-width="2" fill="none" stroke-linecap="round" opacity="0.6"/>
                <!-- Sad mouth -->
                <path d="M 30 70 Q 50 60 70 70" stroke="#8b5cf6" stroke-width="3" fill="none" stroke-linecap="round"/>
            </svg>
            <div style="font-size: 20px; font-weight: 900; color: white; margin-bottom: 10px;">Hesabnz silindi.</div>
            <div style="font-size: 16px; color: #c4b5fd; margin-bottom: 25px;">Sizi kaybettiimiz iin zgnz.</div>
            <button class="profile-action-btn" onclick="window.location.reload()">
                 Tamam
            </button>
        </div>
    </div>
    
    <!-- Logout Confirmation Modal -->
    <div class="change-modal" id="logoutModal">
        <div class="profile-backdrop" onclick="closeLogoutModal()"></div>
        <div class="change-modal-content" style="text-align: center;">
            <div style="font-size: 48px; margin-bottom: 20px;"></div>
            <div style="font-size: 20px; font-weight: 900; color: white; margin-bottom: 10px;">Logout</div>
            <div style="font-size: 16px; color: #c4b5fd; margin-bottom: 25px;">Are you sure you want to logout?</div>
            <div style="display: flex; gap: 10px;">
                <button class="profile-action-btn" onclick="closeLogoutModal()" style="flex: 1; background: rgba(0, 0, 0, 0.4); border: 1px solid rgba(0, 255, 255, 0.25); color: #00ffff;">
                    Cancel
                </button>
                <button class="profile-action-btn profile-logout-btn" onclick="confirmLogout()" style="flex: 1;">
                    Yes, Logout
                </button>
            </div>
        </div>
    </div>
    
    <!-- Full Page Container -->
    <div class="full-page" id="fullPage">
        <div class="full-page-header">
            <button class="back-btn" onclick="closePage()">
                <svg viewBox="0 0 24 24" fill="none">
                    <path d="M19 12H5M12 19l-7-7 7-7"/>
                </svg>
            </button>
            <div class="full-page-title" id="fullPageTitle">Page</div>
        </div>
        <div class="full-page-content" id="fullPageContent">
            <!-- Content will be loaded here -->
        </div>
    </div>

    <script>
        // Auth Management
        let currentUser = null;
        
        function showLogin() {
            document.getElementById('loginForm').style.display = 'block';
            document.getElementById('signupForm').style.display = 'none';
            hideMessages();
        }
        
        function showSignup() {
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('signupForm').style.display = 'block';
            hideMessages();
        }
        
        function hideMessages() {
            document.getElementById('errorMsg').style.display = 'none';
            document.getElementById('successMsg').style.display = 'none';
        }
        
        function showError(msg) {
            const el = document.getElementById('errorMsg');
            el.className = 'error-msg';
            el.textContent = msg;
            el.style.display = 'block';
            setTimeout(() => el.style.display = 'none', 5000);
        }
        
        function showSuccess(msg) {
            const el = document.getElementById('successMsg');
            el.className = 'success-msg';
            el.textContent = msg;
            el.style.display = 'block';
            setTimeout(() => el.style.display = 'none', 3000);
        }
        
        function showToast(message, isError = false) {
            const toast = document.getElementById('toastNotification');
            toast.textContent = message;
            toast.className = 'toast-notification' + (isError ? ' error' : '');
            
            // Trigger show
            setTimeout(() => toast.classList.add('show'), 10);
            
            // Hide after 3 seconds
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
        
        function login() {
            const email = document.getElementById('loginEmail').value.trim();
            const password = document.getElementById('loginPassword').value;
            
            if (!email || !password) {
                showError('Please fill in all fields');
                return;
            }
            
            const users = JSON.parse(localStorage.getItem('users') || '{}');
            const user = users[email];
            
            if (!user || user.password !== password) {
                showError('Invalid email or password');
                return;
            }
            
            currentUser = user;
            localStorage.setItem('currentUser', email);
            showSuccess('Login successful!');
            setTimeout(() => {
                document.getElementById('authScreen').style.display = 'none';
                document.getElementById('app').style.display = 'block';
                initApp();
            }, 1000);
        }
        
        function signup() {
            const username = document.getElementById('signupUsername').value.trim();
            const email = document.getElementById('signupEmail').value.trim();
            const password = document.getElementById('signupPassword').value;
            const passwordConfirm = document.getElementById('signupPasswordConfirm').value;
            const referralCode = document.getElementById('signupReferral').value.trim();
            
            if (!username || !email || !password || !passwordConfirm) {
                showError('Please fill in all required fields');
                return;
            }
            
            if (password.length < 6) {
                showError('Password must be at least 6 characters');
                return;
            }
            
            if (password !== passwordConfirm) {
                showError('Passwords do not match');
                return;
            }
            
            const users = JSON.parse(localStorage.getItem('users') || '{}');
            
            if (users[email]) {
                showError('Email already registered');
                return;
            }
            
            let referralBonus = 0;
            let referredBy = null;
            if (referralCode) {
                let referrerFound = false;
                for (let userEmail in users) {
                    if (users[userEmail].refCode === referralCode) {
                        referrerFound = true;
                        users[userEmail].refs = (users[userEmail].refs || 0) + 1;
                        users[userEmail].rate = (users[userEmail].rate || 1.0) + 0.25;
                        referralBonus = 0.25;
                        referredBy = referralCode; // Store who referred this user
                        break;
                    }
                }
                
                if (!referrerFound) {
                    showError('Invalid referral code');
                    return;
                }
            }
            
            const newRefCode = username;
            
            users[email] = {
                username: username,
                email: email,
                password: password,
                refCode: newRefCode,
                referredBy: referredBy, // Who referred this user
                balance: 0,
                rate: 1.0 + referralBonus,
                level: 1,
                refs: 0,
                streak: 0,
                lastDate: null,
                mining: false,
                timeLeft: 0
            };
            
            localStorage.setItem('users', JSON.stringify(users));
            
            showSuccess('Account created successfully! Please login.');
            setTimeout(() => {
                showLogin();
                document.getElementById('loginEmail').value = email;
            }, 2000);
        }
        
        function googleLogin() {
            showError('Google login is not available in this demo version. Please use email signup.');
        }
        
        function logout() {
            // Remember where we came from before closing
            if (document.getElementById('fullPage').classList.contains('active')) {
                profileOpenedFrom = 'fullpage';
                closePage();
            } else if (document.getElementById('profileModal').classList.contains('show')) {
                profileOpenedFrom = 'modal';
                closeProfile();
            }
            
            // Show logout confirmation modal
            document.getElementById('logoutModal').classList.add('show');
        }
        
        function closeLogoutModal() {
            document.getElementById('logoutModal').classList.remove('show');
            
            // Return to where we came from
            if (profileOpenedFrom === 'fullpage') {
                openPage('profile');
            } else {
                document.getElementById('profileModal').classList.add('show');
            }
        }
        
        function confirmLogout() {
            localStorage.removeItem('currentUser');
            window.location.reload();
        }
        
        function copyReferralCode() {
            const code = currentUser.username;
            
            const textarea = document.createElement('textarea');
            textarea.value = code;
            textarea.style.position = 'fixed';
            textarea.style.opacity = '0';
            document.body.appendChild(textarea);
            textarea.select();
            
            try {
                document.execCommand('copy');
                showSuccess('Referral code copied: ' + code);
            } catch (err) {
                showError('Failed to copy code');
            }
            
            document.body.removeChild(textarea);
        }
        
        function checkAuth() {
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                const users = JSON.parse(localStorage.getItem('users') || '{}');
                currentUser = users[savedUser];
                if (currentUser) {
                    document.getElementById('authScreen').style.display = 'none';
                    document.getElementById('app').style.display = 'block';
                    initApp();
                    return;
                }
            }
            
            document.getElementById('authScreen').style.display = 'flex';
            document.getElementById('app').style.display = 'none';
        }
        
        let d = {};
        let balanceVisible = true;
        let dailyRewardAvailable = false;
        
        // Level system data
        const levelRequirements = {
            1: 0, 2: 5, 3: 10, 4: 15, 5: 20, 6: 30, 7: 40, 8: 50, 9: 60, 10: 75,
            11: 90, 12: 120, 13: 150, 14: 180, 15: 210, 16: 240, 17: 270, 18: 300, 19: 330, 20: 365
        };
        
        const levelRewards = {
            2: {coins: 20, rate: 0.25}, 3: {coins: 30, rate: 0.25}, 4: {coins: 50, rate: 0.25},
            5: {coins: 75, rate: 0.25}, 6: {coins: 100, rate: 0.25}, 7: {coins: 150, rate: 0.25},
            8: {coins: 200, rate: 0.25}, 9: {coins: 300, rate: 0.25}, 10: {coins: 500, rate: 0.25},
            11: {coins: 750, rate: 0.25}, 12: {coins: 1100, rate: 0.25}, 13: {coins: 1500, rate: 0.25},
            14: {coins: 2000, rate: 0.25}, 15: {coins: 2750, rate: 0.25}, 16: {coins: 3500, rate: 0.25},
            17: {coins: 4500, rate: 0.25}, 18: {coins: 6000, rate: 0.25}, 19: {coins: 7500, rate: 0.25},
            20: {coins: 10000, rate: 0.25}
        };
        
        function initApp() {
            d = {
                balance: currentUser.balance || 0,
                rate: currentUser.rate || 1.0,
                level: currentUser.level || 1,
                refs: currentUser.refs || 0,
                activeRefs: 0,
                streak: currentUser.streak || 0,
                lastDate: currentUser.lastDate || null,
                refCode: currentUser.refCode,
                mining: false,
                timeLeft: 0,
                miningDays: currentUser.miningDays || 0,
                pendingLevelUp: currentUser.pendingLevelUp || null
            };
            
            // Calculate active mining referrals
            d.activeRefs = calculateActiveRefs();
            
            dailyRewardAvailable = currentUser.dailyRewardAvailable || false;
            
            // Load balance visibility preference
            const savedBalanceVisible = localStorage.getItem('balanceVisible_' + currentUser.email);
            if (savedBalanceVisible !== null) {
                balanceVisible = savedBalanceVisible === 'true';
            }
            
            checkMining();
            render();
            startTimer();
        }
        
        function calculateActiveRefs() {
            const users = JSON.parse(localStorage.getItem('users') || '{}');
            let activeCount = 0;
            const now = Date.now();
            
            // Check all users who were referred by current user's refCode
            for (let email in users) {
                const user = users[email];
                if (user.referredBy === currentUser.refCode) {
                    // Check if they are currently mining
                    const miningEndTime = localStorage.getItem('miningEndTime_' + email);
                    if (miningEndTime && now < parseInt(miningEndTime)) {
                        activeCount++;
                    }
                }
            }
            
            return activeCount;
        }

        function save() {
            const users = JSON.parse(localStorage.getItem('users') || '{}');
            const userEmail = localStorage.getItem('currentUser');
            
            if (users[userEmail]) {
                users[userEmail].balance = d.balance;
                users[userEmail].rate = d.rate;
                users[userEmail].level = d.level;
                users[userEmail].refs = d.refs;
                users[userEmail].streak = d.streak;
                users[userEmail].lastDate = d.lastDate;
                users[userEmail].miningDays = d.miningDays;
                users[userEmail].pendingLevelUp = d.pendingLevelUp;
                users[userEmail].dailyRewardAvailable = dailyRewardAvailable;
                
                localStorage.setItem('users', JSON.stringify(users));
                currentUser = users[userEmail];
            }
        }
        
        function getLevelProgress() {
            const currentReq = levelRequirements[d.level];
            const nextReq = levelRequirements[d.level + 1];
            
            if (!nextReq) return { progress: 100, current: d.miningDays, required: d.miningDays };
            
            const progress = ((d.miningDays - currentReq) / (nextReq - currentReq)) * 100;
            return {
                progress: Math.min(progress, 100),
                current: d.miningDays,
                required: nextReq
            };
        }
        
        function checkLevelUp() {
            if (d.level >= 20) return;
            
            const nextReq = levelRequirements[d.level + 1];
            if (d.miningDays >= nextReq && !d.pendingLevelUp) {
                d.pendingLevelUp = d.level + 1;
                save();
                render();
            }
        }
        
        function claimLevelReward() {
            if (!d.pendingLevelUp) return;
            
            const reward = levelRewards[d.pendingLevelUp];
            d.balance += reward.coins;
            d.rate += reward.rate;
            d.level = d.pendingLevelUp;
            d.pendingLevelUp = null;
            
            save();
            
            // Check if ready for next level
            checkLevelUp();
            
            render();
        }

        function fmt(s) {
            const h = Math.floor(s / 3600).toString().padStart(2, '0');
            const m = Math.floor((s % 3600) / 60).toString().padStart(2, '0');
            const sec = (s % 60).toString().padStart(2, '0');
            return h + ':' + m + ':' + sec;
        }

        function render() {
            document.getElementById('app').innerHTML = `
                <div class="header">
                    <div class="welcome-card">
                        <span class="welcome-text">Welcome, </span><span class="username-text">${currentUser.username}!</span>
                    </div>
                    <button class="menu-btn" onclick="toggleMenu()">
                        <span></span>
                        <span></span>
                        <span></span>
                    </button>
                </div>

                <div class="card balance-card">
                    <p class="balance-label">Total Balance</p>
                    <div class="balance-container">
                        <div class="balance-value">${balanceVisible ? d.balance.toFixed(2) : ''}</div>
                        <div class="balance-unit"> Pi</div>
                        <button class="balance-toggle" onclick="toggleBalance()">
                            ${balanceVisible ? `
                                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                                    <circle cx="12" cy="12" r="3"/>
                                </svg>
                            ` : `
                                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                                    <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
                                    <line x1="1" y1="1" x2="23" y2="23"/>
                                </svg>
                            `}
                        </button>
                    </div>
                </div>

                <div class="card ${d.mining ? 'mining-glow' : ''}" id="miningCard">
                    ${!d.mining ? `
                        <button class="btn-mine" onclick="startMine()">
                            <svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5">
                                <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/>
                            </svg>
                            Start Mining
                        </button>
                    ` : `
                        <div class="timer-wrap">
                            <div class="timer-circle">
                                <svg viewBox="0 0 150 150">
                                    <circle class="timer-bg" cx="75" cy="75" r="70"/>
                                    <circle class="timer-progress" cx="75" cy="75" r="70" stroke-dasharray="440" 
                                        stroke-dashoffset="${440 - ((86400 - d.timeLeft) / 86400) * 440}"/>
                                </svg>
                                <div class="timer-icon">
                                    <svg viewBox="0 0 24 24" fill="none" stroke-width="2.5">
                                        <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/>
                                    </svg>
                                </div>
                            </div>
                            <p class="mining-active"> Mining Active</p>
                            <p class="timer-time">${fmt(d.timeLeft)}</p>
                            <p class="timer-label">Time Remaining</p>
                            <div class="earning-box">
                                <p class="earning-text">Earning: <span class="earning-amount">${(d.rate * 6).toFixed(2)}  Pi</span></p>
                            </div>
                        </div>
                    `}
                </div>

                <div class="stats">
                    <div class="stat">
                        <div class="stat-top">
                            <div class="stat-icon icon-blue">
                                <svg viewBox="0 0 24 24"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/></svg>
                            </div>
                            <span class="stat-label">Mining Rate</span>
                        </div>
                        <div class="stat-value">${d.rate.toFixed(2)}</div>
                        <div class="stat-unit">/hour</div>
                    </div>

                    <div class="stat">
                        <div class="stat-top">
                            <div class="stat-icon icon-purple">
                                <svg viewBox="0 0 24 24"><circle cx="12" cy="8" r="7"/><polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"/></svg>
                            </div>
                            <span class="stat-label">Level</span>
                        </div>
                        ${d.pendingLevelUp ? `
                            <div style="text-align: center; padding: 2px 0;">
                                <p class="congrats-text" style="font-size: 13px; margin-bottom: 2px;">Congrats!</p>
                                <p class="level-reached-text" style="font-size: 11px; margin-bottom: 2px;">Level ${d.pendingLevelUp}</p>
                                <p class="reward-text" style="font-size: 10px; margin-bottom: 4px;">+${levelRewards[d.pendingLevelUp].coins} coins</p>
                                <button class="claim-btn" onclick="claimLevelReward()">CLAIM</button>
                            </div>
                        ` : `
                            <div class="stat-value">${d.level}</div>
                            <div class="stat-unit">Level</div>
                            ${d.level < 20 ? `
                                <div class="level-progress-bar">
                                    <div class="level-progress-fill" style="width: ${getLevelProgress().progress}%"></div>
                                    <div class="level-progress-text">${getLevelProgress().current}/${getLevelProgress().required} Days</div>
                                </div>
                            ` : '<div class="stat-unit" style="margin-top: 8px; color: #fbbf24;">MAX LEVEL</div>'}
                        `}
                    </div>

                    <div class="stat">
                        <div class="stat-top">
                            <div class="stat-icon icon-green">
                                <svg viewBox="0 0 24 24"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                            </div>
                            <span class="stat-label">Referrals</span>
                        </div>
                        <div class="stat-value">${d.activeRefs}/${d.refs}</div>
                        <div class="stat-unit">Active Mining</div>
                    </div>

                    <div class="stat ${dailyRewardAvailable ? 'reward-available' : ''}">
                        <div class="stat-top">
                            <div class="stat-icon icon-orange">
                                <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
                            </div>
                            <span class="stat-label">Daily Reward</span>
                        </div>
                        <div class="reward-card" style="display: flex; flex-direction: column; align-items: center; justify-content: flex-start; min-height: 90px; padding: 15px 10px 10px 10px;">
                            <div class="reward-chest ${dailyRewardAvailable ? 'available' : 'locked'}" style="width: 50px; height: 50px; margin: -15px auto 10px;">
                                <svg viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <!-- Gift Box Base -->
                                    <rect x="20" y="45" width="60" height="40" rx="3" stroke="#00bcd4" stroke-width="3" fill="none"/>
                                    
                                    <!-- Gift Box Lid -->
                                    <path d="M 18 40 L 82 40 L 82 48 L 18 48 Z" stroke="#00bcd4" stroke-width="3" fill="none"/>
                                    
                                    <!-- Vertical Ribbon -->
                                    <line x1="50" y1="40" x2="50" y2="85" stroke="#00ffff" stroke-width="4"/>
                                    
                                    <!-- Horizontal Ribbon -->
                                    <line x1="20" y1="65" x2="80" y2="65" stroke="#00ffff" stroke-width="4"/>
                                    
                                    <!-- Bow Left -->
                                    <path d="M 35 30 Q 30 35 35 40" stroke="#00ffff" stroke-width="3" fill="none"/>
                                    <path d="M 35 30 Q 40 25 45 30" stroke="#00ffff" stroke-width="3" fill="none"/>
                                    
                                    <!-- Bow Right -->
                                    <path d="M 65 30 Q 70 35 65 40" stroke="#00ffff" stroke-width="3" fill="none"/>
                                    <path d="M 65 30 Q 60 25 55 30" stroke="#00ffff" stroke-width="3" fill="none"/>
                                    
                                    <!-- Bow Center -->
                                    <circle cx="50" cy="35" r="5" stroke="#00d4d4" stroke-width="3" fill="none"/>
                                    
                                    <!-- Sparkles (when available) -->
                                    ${dailyRewardAvailable ? `
                                    <line x1="15" y1="25" x2="15" y2="25" stroke="#00ffff" stroke-width="2" stroke-linecap="round">
                                        <animate attributeName="y1" values="25;20;25" dur="1.5s" repeatCount="indefinite"/>
                                        <animate attributeName="y2" values="25;30;25" dur="1.5s" repeatCount="indefinite"/>
                                    </line>
                                    <line x1="85" y1="30" x2="85" y2="30" stroke="#00ffff" stroke-width="2" stroke-linecap="round">
                                        <animate attributeName="y1" values="30;25;30" dur="1.5s" repeatCount="indefinite" begin="0.5s"/>
                                        <animate attributeName="y2" values="30;35;30" dur="1.5s" repeatCount="indefinite" begin="0.5s"/>
                                    </line>
                                    <line x1="20" y1="80" x2="20" y2="80" stroke="#00ffff" stroke-width="2" stroke-linecap="round">
                                        <animate attributeName="y1" values="80;75;80" dur="1.5s" repeatCount="indefinite" begin="1s"/>
                                        <animate attributeName="y2" values="80;85;80" dur="1.5s" repeatCount="indefinite" begin="1s"/>
                                    </line>
                                    ` : ''}
                                </svg>
                            </div>
                            ${dailyRewardAvailable ? `
                                <button class="reward-claim-btn" onclick="claimDailyReward()">
                                    <span>CLAIM REWARD</span>
                                </button>
                            ` : ''}
                        </div>
                    </div>
                    </div>

                <div class="card">
                    <div class="section-title">
                        <svg viewBox="0 0 24 24" fill="none" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                        Your Referral Code
                    </div>
                    <div class="ref-compact">
                        <div class="ref-code-text">${currentUser.username}</div>
                        <button class="copy-btn" onclick="copyReferralCode()">
                            <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
                                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>
                            </svg>
                            Copy
                        </button>
                    </div>
                </div>

                <button class="logout-btn" onclick="logout()" style="display:none;">Logout</button>

                <div class="footer" style="display:none;">
                    <p class="footer-text"> This is a demo application. Not real cryptocurrency.</p>
                </div>
            `;
        }

        function startMine() {
            const now = Date.now();
            const end = now + (24 * 60 * 60 * 1000);
            localStorage.setItem('miningEndTime_' + currentUser.email, end);
            d.mining = true;
            d.timeLeft = 24 * 60 * 60;

            const today = new Date().toDateString();
            if (d.lastDate) {
                const last = new Date(d.lastDate);
                const yesterday = new Date();
                yesterday.setDate(yesterday.getDate() - 1);
                if (last.toDateString() === yesterday.toDateString()) {
                    d.streak++;
                } else if (last.toDateString() !== today) {
                    d.streak = 1;
                }
            } else {
                d.streak = 1;
            }
            d.lastDate = today;
            save();
            render();
        }

        function completeMine() {
            d.mining = false;
            d.timeLeft = 0;
            localStorage.removeItem('miningEndTime_' + currentUser.email);
            d.balance += d.rate * 6;
            d.miningDays++;
            dailyRewardAvailable = true;
            
            save();
            checkLevelUp();
            render();
        }
        
        function claimDailyReward() {
            if (!dailyRewardAvailable) return;
            
            d.balance += 5;
            dailyRewardAvailable = false;
            
            save();
            showSuccess(' Daily reward claimed: +5 Pi!');
            render();
        }

        function claimBonus() {
            if (d.streak >= 7) {
                const bonus = d.streak * 10;
                d.balance += bonus;
                save();
                showSuccess(' ' + d.streak + ' day streak bonus: +' + bonus + ' Pi!');
                render();
            }
        }
        
        function toggleBalance() {
            balanceVisible = !balanceVisible;
            localStorage.setItem('balanceVisible_' + currentUser.email, balanceVisible);
            render();
        }

        function checkMining() {
            const end = localStorage.getItem('miningEndTime_' + currentUser.email);
            if (end) {
                const now = Date.now();
                const endTime = parseInt(end);
                if (now < endTime) {
                    d.mining = true;
                    d.timeLeft = Math.floor((endTime - now) / 1000);
                } else {
                    completeMine();
                }
            }
        }

        function startTimer() {
            setInterval(function() {
                if (d.mining && d.timeLeft > 0) {
                    d.timeLeft--;
                    if (d.timeLeft <= 0) {
                        completeMine();
                    }
                    render();
                }
                
                // Update active referrals count every 10 seconds
                if (Date.now() % 10000 < 1000) {
                    d.activeRefs = calculateActiveRefs();
                }
            }, 1000);
        }
        
        function createParticles() {
            // Disabled for performance
        }
        
        function toggleMenu() {
            const sidebar = document.getElementById('menuSidebar');
            const overlay = document.getElementById('menuOverlay');
            sidebar.classList.toggle('open');
            overlay.classList.toggle('show');
            
            // Prevent background scrolling when menu is open
            if (sidebar.classList.contains('open')) {
                document.body.style.overflow = 'hidden';
            } else {
                document.body.style.overflow = 'auto';
            }
        }
        
        function showProfile() {
            toggleMenu();
            document.getElementById('profileUsername').textContent = currentUser.username;
            document.getElementById('profileHandle').textContent = '@' + currentUser.username;
            
            // Personal information
            document.getElementById('inputFullName').value = d.fullName || '';
            document.getElementById('profileEmail').textContent = currentUser.email;
            document.getElementById('inputBirthDate').value = d.birthDate || '';
            document.getElementById('inputCountry').value = d.country || '';
            
            // Reset edit mode
            document.getElementById('inputFullName').disabled = true;
            document.getElementById('inputBirthDate').disabled = true;
            document.getElementById('inputCountry').disabled = true;
            document.getElementById('saveInfoBtn').style.display = 'none';
            document.getElementById('editInfoBtn').style.display = 'block';
            
            document.getElementById('profileModal').classList.add('show');
        }
        
        function toggleEditInfo() {
            const inputs = [
                document.getElementById('inputFullName'),
                document.getElementById('inputBirthDate'),
                document.getElementById('inputCountry')
            ];
            
            const isDisabled = inputs[0].disabled;
            
            inputs.forEach(input => input.disabled = !isDisabled);
            
            // Hide error when entering edit mode
            if (isDisabled) {
                document.getElementById('birthDateError').style.display = 'none';
            }
            
            document.getElementById('saveInfoBtn').style.display = isDisabled ? 'block' : 'none';
            document.getElementById('editInfoBtn').style.display = isDisabled ? 'none' : 'block';
        }
        
        function savePersonalInfo() {
            d.fullName = document.getElementById('inputFullName').value;
            d.birthDate = document.getElementById('inputBirthDate').value;
            d.country = document.getElementById('inputCountry').value;
            
            // Validate birth date
            if (d.birthDate) {
                const year = parseInt(d.birthDate.split('-')[0]);
                if (year < 1923 || year > 2007) {
                    document.getElementById('birthDateError').style.display = 'block';
                    return;
                }
            }
            
            // Hide error if validation passed
            document.getElementById('birthDateError').style.display = 'none';
            
            save();
            
            // Also save to users object
            const users = JSON.parse(localStorage.getItem('users') || '{}');
            if (users[currentUser.email]) {
                users[currentUser.email].fullName = d.fullName;
                users[currentUser.email].birthDate = d.birthDate;
                users[currentUser.email].country = d.country;
                localStorage.setItem('users', JSON.stringify(users));
            }
            
            // Disable inputs and hide save button
            document.getElementById('inputFullName').disabled = true;
            document.getElementById('inputBirthDate').disabled = true;
            document.getElementById('inputCountry').disabled = true;
            document.getElementById('saveInfoBtn').style.display = 'none';
            document.getElementById('editInfoBtn').style.display = 'block';
            
            showToast(' Personal information saved successfully!');
        }
        
        function closeProfile() {
            document.getElementById('profileModal').classList.remove('show');
        }
        
        function uploadAvatar() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = function(event) {
                    const img = new Image();
                    img.onload = function() {
                        // Resize image to 500x500
                        const canvas = document.createElement('canvas');
                        const ctx = canvas.getContext('2d');
                        canvas.width = 500;
                        canvas.height = 500;
                        
                        // Calculate crop dimensions to make it square
                        const size = Math.min(img.width, img.height);
                        const x = (img.width - size) / 2;
                        const y = (img.height - size) / 2;
                        
                        ctx.drawImage(img, x, y, size, size, 0, 0, 500, 500);
                        
                        // Smart compression - try different quality levels
                        let quality = 0.8;
                        let resizedImage = canvas.toDataURL('image/jpeg', quality);
                        let attempts = 0;
                        const maxAttempts = 5;
                        const targetSize = 204800; // 200KB in bytes
                        
                        // Keep reducing quality until under 200KB or max attempts reached
                        while (resizedImage.length * 0.75 > targetSize && attempts < maxAttempts) {
                            quality -= 0.2;
                            if (quality < 0.1) quality = 0.1;
                            resizedImage = canvas.toDataURL('image/jpeg', quality);
                            attempts++;
                        }
                        
                        // Check final size
                        const finalSize = resizedImage.length * 0.75; // Approximate bytes
                        if (finalSize > targetSize) {
                            showToast(' Image is too large. Please select a smaller image.', true);
                            return;
                        }
                        
                        // Save to data
                        d.avatarImage = resizedImage;
                        save();
                        
                        // Update display
                        showProfile();
                        showSuccess(' Profile photo updated!');
                    };
                    img.src = event.target.result;
                };
                reader.readAsDataURL(file);
            };
            input.click();
        }
        
        let profileOpenedFrom = 'modal'; // Track where profile was opened from
        
        const countries = [
            'Afghanistan', 'Albania', 'Algeria', 'Argentina', 'Australia', 'Austria', 'Azerbaijan',
            'Bangladesh', 'Belgium', 'Brazil', 'Bulgaria', 'Canada', 'Chile', 'China', 'Colombia',
            'Croatia', 'Czech Republic', 'Denmark', 'Egypt', 'Finland', 'France', 'Germany', 'Greece',
            'Hungary', 'Iceland', 'India', 'Indonesia', 'Iran', 'Iraq', 'Ireland', 'Israel', 'Italy',
            'Japan', 'Jordan', 'Kazakhstan', 'Kenya', 'Kuwait', 'Lebanon', 'Libya', 'Malaysia', 'Mexico',
            'Morocco', 'Netherlands', 'New Zealand', 'Nigeria', 'Norway', 'Pakistan', 'Philippines',
            'Poland', 'Portugal', 'Qatar', 'Romania', 'Russia', 'Saudi Arabia', 'Serbia', 'Singapore',
            'South Africa', 'South Korea', 'Spain', 'Sweden', 'Switzerland', 'Syria', 'Taiwan', 'Thailand',
            'Tunisia', 'Turkey', 'Ukraine', 'United Arab Emirates', 'United Kingdom', 'United States',
            'Uzbekistan', 'Venezuela', 'Vietnam'
        ];
        
        function showCountryDropdown(inputId, dropdownId) {
            const input = document.getElementById(inputId);
            const dropdown = document.getElementById(dropdownId);
            
            if (input.disabled) return;
            
            // Populate dropdown
            dropdown.innerHTML = countries.map(country => 
                `<div class="country-option" onclick="selectCountry('${country}', '${inputId}', '${dropdownId}')">${country}</div>`
            ).join('');
            
            dropdown.classList.add('show');
        }
        
        function filterCountries(inputId, dropdownId) {
            const input = document.getElementById(inputId);
            const dropdown = document.getElementById(dropdownId);
            const filter = input.value.toLowerCase();
            
            if (!filter) {
                showCountryDropdown(inputId, dropdownId);
                return;
            }
            
            const filtered = countries.filter(country => 
                country.toLowerCase().includes(filter)
            );
            
            if (filtered.length > 0) {
                dropdown.innerHTML = filtered.map(country => 
                    `<div class="country-option" onclick="selectCountry('${country}', '${inputId}', '${dropdownId}')">${country}</div>`
                ).join('');
                dropdown.classList.add('show');
            } else {
                dropdown.classList.remove('show');
            }
        }
        
        function selectCountry(country, inputId, dropdownId) {
            document.getElementById(inputId).value = country;
            document.getElementById(dropdownId).classList.remove('show');
        }
        
        // Close dropdown when clicking outside
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.country-dropdown')) {
                document.querySelectorAll('.country-dropdown-list').forEach(dropdown => {
                    dropdown.classList.remove('show');
                });
            }
        });
        
        function showChangeEmail() {
            // Remember where we came from
            if (document.getElementById('fullPage').classList.contains('active')) {
                profileOpenedFrom = 'fullpage';
                closePage();
            } else {
                profileOpenedFrom = 'modal';
                closeProfile();
            }
            document.getElementById('changeEmailModal').classList.add('show');
        }
        
        function closeChangeEmail() {
            document.getElementById('changeEmailModal').classList.remove('show');
            document.getElementById('newEmail').value = '';
            document.getElementById('emailPassword').value = '';
            
            // Return to where we came from
            if (profileOpenedFrom === 'fullpage') {
                openPage('profile');
            } else {
                document.getElementById('profileModal').classList.add('show');
            }
        }
        
        function changeEmail() {
            const newEmail = document.getElementById('newEmail').value;
            const password = document.getElementById('emailPassword').value;
            
            if (!newEmail || !password) {
                showToast('Please fill all fields', true);
                return;
            }
            
            const users = JSON.parse(localStorage.getItem('users') || '{}');
            if (users[currentUser.email].password !== password) {
                showToast('Incorrect password', true);
                return;
            }
            
            if (users[newEmail]) {
                showToast('Email already exists', true);
                return;
            }
            
            users[newEmail] = users[currentUser.email];
            users[newEmail].email = newEmail;
            delete users[currentUser.email];
            
            localStorage.setItem('users', JSON.stringify(users));
            currentUser.email = newEmail;
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            
            closeChangeEmail();
            showToast(' Email changed successfully!');
        }
        
        function showChangePassword() {
            // Remember where we came from
            if (document.getElementById('fullPage').classList.contains('active')) {
                profileOpenedFrom = 'fullpage';
                closePage();
            } else {
                profileOpenedFrom = 'modal';
                closeProfile();
            }
            document.getElementById('changePasswordModal').classList.add('show');
        }
        
        function closeChangePassword() {
            document.getElementById('changePasswordModal').classList.remove('show');
            document.getElementById('currentPassword').value = '';
            document.getElementById('newPassword').value = '';
            document.getElementById('confirmPassword').value = '';
            
            // Return to where we came from
            if (profileOpenedFrom === 'fullpage') {
                openPage('profile');
            } else {
                document.getElementById('profileModal').classList.add('show');
            }
        }
        
        function changePassword() {
            const currentPwd = document.getElementById('currentPassword').value;
            const newPwd = document.getElementById('newPassword').value;
            const confirmPwd = document.getElementById('confirmPassword').value;
            
            if (!currentPwd || !newPwd || !confirmPwd) {
                showToast('Please fill all fields', true);
                return;
            }
            
            const users = JSON.parse(localStorage.getItem('users') || '{}');
            if (users[currentUser.email].password !== currentPwd) {
                showToast('Incorrect current password', true);
                return;
            }
            
            if (newPwd !== confirmPwd) {
                showToast('Passwords do not match', true);
                return;
            }
            
            if (newPwd.length < 6) {
                showToast('Password must be at least 6 characters', true);
                return;
            }
            
            users[currentUser.email].password = newPwd;
            localStorage.setItem('users', JSON.stringify(users));
            
            closeChangePassword();
            showToast(' Password changed successfully!');
        }
        
        function shareProfile() {
            const shareText = `Check out my Pi Mining profile!\n\n ${currentUser.username}\n Level ${d.level}\n ${d.balance.toFixed(2)} \n Referral Code: ${currentUser.referralCode}`;
            
            if (navigator.share) {
                navigator.share({
                    title: 'Pi Mining Profile',
                    text: shareText
                }).catch(() => {
                    copyToClipboard(shareText);
                });
            } else {
                copyToClipboard(shareText);
            }
        }
        
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                showToast(' Profile info copied to clipboard!');
            }).catch(() => {
                showToast(' Share: ' + text);
            });
        }
        
        function copyProfileLink() {
            const url = window.location.href;
            navigator.clipboard.writeText(url).then(() => {
                showToast(' Profile link copied!');
            });
        }
        
        function showDeleteAccount() {
            // Remember where we came from
            if (document.getElementById('fullPage').classList.contains('active')) {
                profileOpenedFrom = 'fullpage';
                closePage();
            } else {
                profileOpenedFrom = 'modal';
                closeProfile();
            }
            document.getElementById('deleteError').style.display = 'none';
            document.getElementById('deleteAccountModal').classList.add('show');
        }
        
        function closeDeleteAccount() {
            document.getElementById('deleteAccountModal').classList.remove('show');
            document.getElementById('deletePassword').value = '';
            document.getElementById('deleteError').style.display = 'none';
            
            // Return to where we came from
            if (profileOpenedFrom === 'fullpage') {
                openPage('profile');
            } else {
                document.getElementById('profileModal').classList.add('show');
            }
        }
        
        function showDeleteError(message) {
            document.getElementById('deleteErrorText').textContent = message;
            document.getElementById('deleteError').style.display = 'block';
        }
        
        function confirmDeleteAccount() {
            const password = document.getElementById('deletePassword').value;
            
            if (!password) {
                showDeleteError('Please enter your password');
                return;
            }
            
            const users = JSON.parse(localStorage.getItem('users') || '{}');
            
            if (users[currentUser.email].password !== password) {
                showDeleteError('Incorrect password');
                return;
            }
            
            // Password correct - delete account
            deleteAccount();
        }
        
        function deleteAccount() {
            const users = JSON.parse(localStorage.getItem('users') || '{}');
            delete users[currentUser.email];
            localStorage.setItem('users', JSON.stringify(users));
            localStorage.removeItem('currentUser');
            localStorage.removeItem('userData_' + currentUser.email);
            localStorage.removeItem('miningEndTime_' + currentUser.email);
            
            // Close delete modal
            document.getElementById('deleteAccountModal').classList.remove('show');
            
            // Show goodbye modal
            document.getElementById('goodbyeModal').classList.add('show');
        }
        
        function openPage(page) {
            toggleMenu();
            
            const fullPage = document.getElementById('fullPage');
            const pageTitle = document.getElementById('fullPageTitle');
            const pageContent = document.getElementById('fullPageContent');
            
            switch(page) {
                case 'profile':
                    pageTitle.textContent = 'Profile';
                    pageContent.innerHTML = getProfilePageContent();
                    break;
                case 'menu2':
                    pageTitle.textContent = 'Men 2';
                    pageContent.innerHTML = '<div class="card"><h2 style="color: white; text-align: center;">Men 2 erii</h2><p style="color: #c4b5fd; text-align: center; margin-top: 10px;">Bu sayfa iin ierik yaknda eklenecek.</p></div>';
                    break;
                case 'menu3':
                    pageTitle.textContent = 'Men 3';
                    pageContent.innerHTML = '<div class="card"><h2 style="color: white; text-align: center;">Men 3 erii</h2><p style="color: #c4b5fd; text-align: center; margin-top: 10px;">Bu sayfa iin ierik yaknda eklenecek.</p></div>';
                    break;
                case 'menu4':
                    pageTitle.textContent = 'Men 4';
                    pageContent.innerHTML = '<div class="card"><h2 style="color: white; text-align: center;">Men 4 erii</h2><p style="color: #c4b5fd; text-align: center; margin-top: 10px;">Bu sayfa iin ierik yaknda eklenecek.</p></div>';
                    break;
                case 'menu5':
                    pageTitle.textContent = 'Men 5';
                    pageContent.innerHTML = '<div class="card"><h2 style="color: white; text-align: center;">Men 5 erii</h2><p style="color: #c4b5fd; text-align: center; margin-top: 10px;">Bu sayfa iin ierik yaknda eklenecek.</p></div>';
                    break;
                case 'menu6':
                    pageTitle.textContent = 'Men 6';
                    pageContent.innerHTML = '<div class="card"><h2 style="color: white; text-align: center;">Men 6 erii</h2><p style="color: #c4b5fd; text-align: center; margin-top: 10px;">Bu sayfa iin ierik yaknda eklenecek.</p></div>';
                    break;
            }
            
            fullPage.classList.add('active');
            fullPage.dataset.currentPage = page;
            
            // Push state for back button handling (with error handling)
            try {
                history.pushState({ page: page }, '', '#' + page);
            } catch(e) {
                // History API not available or restricted
            }
        }
        
        function closePage() {
            const fullPage = document.getElementById('fullPage');
            fullPage.classList.remove('active');
            fullPage.dataset.currentPage = '';
            
            // Replace state to remove hash (with error handling)
            try {
                if (window.location.hash) {
                    history.replaceState(null, '', window.location.pathname);
                }
            } catch(e) {
                // History API not available or restricted
            }
        }
        
        function getProfilePageContent() {
            return `
                <div style="background: rgba(0, 0, 0, 0.4); border: 1px solid rgba(0, 255, 255, 0.2); border-radius: 12px; padding: 15px; margin-bottom: 25px; text-align: center;">
                    <div style="font-size: 20px; font-weight: 900; color: white;">${currentUser.username}</div>
                    <div style="font-size: 13px; color: #8b5cf6; margin-top: 4px;">@${currentUser.username}</div>
                </div>
                
                <div style="margin-bottom: 25px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                        <div style="font-size: 14px; color: #8b5cf6; font-weight: 700; text-transform: uppercase; letter-spacing: 1px;">Personal Information</div>
                        <button id="editInfoBtnPage" onclick="toggleEditInfoPage()" style="background: rgba(0, 255, 255, 0.2); border: 1px solid rgba(0, 255, 255, 0.4); border-radius: 8px; padding: 6px 12px; color: #00ffff; font-size: 12px; font-weight: 700; cursor: pointer;">
                             Edit
                        </button>
                    </div>
                    <div style="background: rgba(0, 0, 0, 0.3); border: 1px solid rgba(0, 255, 255, 0.15); border-radius: 12px; padding: 14px; margin-bottom: 10px;">
                        <div style="font-size: 11px; color: #8b5cf6; font-weight: 600; margin-bottom: 6px;">Full Name</div>
                        <input type="text" id="inputFullNamePage" class="form-input" placeholder="Enter your full name" value="${d.fullName || ''}" style="margin: 0;" disabled>
                    </div>
                    <div style="background: rgba(0, 0, 0, 0.3); border: 1px solid rgba(0, 255, 255, 0.15); border-radius: 12px; padding: 14px; margin-bottom: 10px;">
                        <div style="font-size: 11px; color: #8b5cf6; font-weight: 600; margin-bottom: 6px;">Email Address</div>
                        <div style="font-size: 15px; color: #666; font-weight: 700;">${currentUser.email}</div>
                    </div>
                    <div style="background: rgba(0, 0, 0, 0.3); border: 1px solid rgba(0, 255, 255, 0.15); border-radius: 12px; padding: 14px; margin-bottom: 10px;">
                        <div style="font-size: 11px; color: #8b5cf6; font-weight: 600; margin-bottom: 6px;">Birth Date</div>
                        <input type="date" id="inputBirthDatePage" class="form-input" value="${d.birthDate || ''}" style="margin: 0;" min="1923-01-01" max="2007-12-31" disabled>
                        <div id="birthDateErrorPage" style="display: none; margin-top: 8px; padding: 8px; background: rgba(239, 68, 68, 0.2); border: 1px solid rgba(239, 68, 68, 0.5); border-radius: 8px; color: #fca5a5; font-size: 12px; font-weight: 600;">
                             Birth year must be between 1923 and 2007
                        </div>
                    </div>
                    <div style="background: rgba(0, 0, 0, 0.3); border: 1px solid rgba(0, 255, 255, 0.15); border-radius: 12px; padding: 14px; margin-bottom: 10px;">
                        <div style="font-size: 11px; color: #8b5cf6; font-weight: 600; margin-bottom: 6px;">Country</div>
                        <div class="country-dropdown">
                            <input type="text" id="inputCountryPage" class="form-input" placeholder="Select or type your country" value="${d.country || ''}" style="margin: 0;" disabled autocomplete="off" onfocus="showCountryDropdown('inputCountryPage', 'countryDropdownPage')" oninput="filterCountries('inputCountryPage', 'countryDropdownPage')">
                            <div id="countryDropdownPage" class="country-dropdown-list"></div>
                        </div>
                    </div>
                    <button id="saveInfoBtnPage" class="profile-action-btn" onclick="savePersonalInfoPage()" style="background: linear-gradient(135deg, #00ffff, #0096ff); color: #000; font-weight: 900; display: none;">
                         Save Information
                    </button>
                </div>
                
                <div style="margin-bottom: 25px;">
                    <div style="font-size: 14px; color: #8b5cf6; font-weight: 700; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 12px;">Account Settings</div>
                    <button class="profile-action-btn" onclick="showChangeEmail()"> Change Email</button>
                    <button class="profile-action-btn" onclick="showChangePassword()"> Change Password</button>
                </div>
                
                <div style="margin-bottom: 25px;">
                    <div style="font-size: 14px; color: #8b5cf6; font-weight: 700; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 12px;">Share Profile</div>
                    <button class="profile-action-btn" onclick="shareProfile()">
                        <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" style="display: inline-block; vertical-align: middle; margin-right: 8px;">
                            <circle cx="18" cy="5" r="3"/>
                            <circle cx="6" cy="12" r="3"/>
                            <circle cx="18" cy="19" r="3"/>
                            <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"/>
                            <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"/>
                        </svg>
                        Share Profile
                    </button>
                </div>
                
                <div style="margin-bottom: 25px;">
                    <button class="profile-action-btn profile-logout-btn" onclick="logout()"> Logout</button>
                    <button class="profile-action-btn profile-delete-btn" onclick="showDeleteAccount()"> Delete Account</button>
                </div>
            `;
        }
        
        function toggleEditInfoPage() {
            const inputs = [
                document.getElementById('inputFullNamePage'),
                document.getElementById('inputBirthDatePage'),
                document.getElementById('inputCountryPage')
            ];
            
            const isDisabled = inputs[0].disabled;
            
            inputs.forEach(input => input.disabled = !isDisabled);
            
            // Hide error when entering edit mode
            if (isDisabled) {
                document.getElementById('birthDateErrorPage').style.display = 'none';
            }
            
            document.getElementById('saveInfoBtnPage').style.display = isDisabled ? 'block' : 'none';
            document.getElementById('editInfoBtnPage').style.display = isDisabled ? 'none' : 'block';
        }
        
        function savePersonalInfoPage() {
            d.fullName = document.getElementById('inputFullNamePage').value;
            d.birthDate = document.getElementById('inputBirthDatePage').value;
            d.country = document.getElementById('inputCountryPage').value;
            
            // Validate birth date
            if (d.birthDate) {
                const year = parseInt(d.birthDate.split('-')[0]);
                if (year < 1923 || year > 2007) {
                    document.getElementById('birthDateErrorPage').style.display = 'block';
                    return;
                }
            }
            
            // Hide error if validation passed
            document.getElementById('birthDateErrorPage').style.display = 'none';
            
            save();
            
            // Also save to users object
            const users = JSON.parse(localStorage.getItem('users') || '{}');
            if (users[currentUser.email]) {
                users[currentUser.email].fullName = d.fullName;
                users[currentUser.email].birthDate = d.birthDate;
                users[currentUser.email].country = d.country;
                localStorage.setItem('users', JSON.stringify(users));
            }
            
            // Disable inputs and hide save button
            document.getElementById('inputFullNamePage').disabled = true;
            document.getElementById('inputBirthDatePage').disabled = true;
            document.getElementById('inputCountryPage').disabled = true;
            document.getElementById('saveInfoBtnPage').style.display = 'none';
            document.getElementById('editInfoBtnPage').style.display = 'block';
            
            showToast(' Personal information saved successfully!');
        }
        
        function changeAvatarInPage(color) {
            d.avatarColor = color;
            save();
            openPage('profile');
        }
        
        createParticles();
        checkAuth();
        
        // Handle back button (with error handling for restricted environments)
        try {
            window.addEventListener('popstate', function(event) {
                const fullPage = document.getElementById('fullPage');
                if (fullPage && fullPage.classList.contains('active')) {
                    closePage();
                }
            });
            
            // Set initial state
            history.replaceState(null, '', window.location.pathname);
        } catch(e) {
            // History API not available or restricted - use alternative
            // Listen for hashchange as fallback
            window.addEventListener('hashchange', function() {
                if (!window.location.hash) {
                    const fullPage = document.getElementById('fullPage');
                    if (fullPage && fullPage.classList.contains('active')) {
                        closePage();
                    }
                }
            });
        }
    </script>
</body>
</html>
